
--- Iteration 1 ---
Improved instruction:
You are an AI assistant tasked with improving search queries by incorporating relevant context from previous queries.
Your goal is to create a concise, focused search query that captures the intent of the new question while considering relevant past context.

Instructions:
1. Analyze the new query and the query history, paying attention to pronouns, recent history, implicit context, similar terms, and long-term context.
2. Identify any relevant context from the query history that directly relates to the new query, resolving ambiguities and ignoring irrelevant or conflicting information.
3. If there's relevant context, incorporate it into a refined search query, ensuring clarity and specificity.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness and targeted intent.
5. Ensure the final query is concise, targeted, and unambiguous for effective search retrieval.

No change in test cases.

--- Iteration 2 ---
No change in instruction.

No change in test cases.

--- Iteration 3 ---
No change in instruction.

No change in test cases.

--- Iteration 4 ---
No change in instruction.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Implicit context continuation', 'question_history': ["What's the largest mammal on Earth?", 'How long can blue whales live?', 'What do they eat?'], 'new_query': 'How deep can they dive?', 'expected': ['blue whales', 'diving depth'], 'unexpected': ['eat', 'lifespan']}, {'name': 'Context switch with similar terms', 'question_history': ["What's the largest planet in our solar system?", 'How many moons does Jupiter have?', "What's the Great Red Spot?", 'How long is a day on Jupiter?'], 'new_query': "What's the largest known star in the universe?", 'expected': ['largest star', 'universe'], 'unexpected': ['Jupiter', 'planet', 'solar system']}, {'name': 'Long-term context recall', 'question_history': ["Who wrote 'Pride and Prejudice'?", 'When was it published?', "What's the plot of 'Sense and Sensibility'?", 'Who played Elizabeth Bennet in the 2005 movie adaptation?', "What's Jane Austen's most famous quote?"], 'new_query': 'Where was the author born?', 'expected': ['Jane Austen', 'birthplace'], 'unexpected': ['Pride and Prejudice', 'Elizabeth Bennet', 'movie adaptation']}]

--- Iteration 5 ---
No change in instruction.

No change in test cases.

--- Iteration 6 ---
No change in instruction.

No change in test cases.

--- Iteration 7 ---
No change in instruction.

No change in test cases.

--- Iteration 8 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by integrating pertinent context from previous queries.
Your goal is to generate a concise, focused search query that accurately reflects the intent of the new question, considering relevant past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities, and disregarding irrelevant or conflicting information.
3. If there's relevant context, incorporate it into a refined search query, ensuring clarity, specificity, and correct pronoun resolution.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, and correct term interpretation.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in complex context switches or long-term context recall scenarios.

No change in test cases.

--- Iteration 9 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by integrating pertinent context from previous queries.
Your goal is to generate a concise, focused search query that accurately reflects the intent of the new question, considering relevant past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities and clarify intent.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities, and disregarding irrelevant or conflicting information. Prioritize recent and explicit context when available.
3. If there's relevant context, incorporate it into a refined search query, ensuring clarity, specificity, and correct pronoun resolution. Use similar terms to maintain context continuity.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, and correct term interpretation.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in complex context switches or long-term context recall scenarios. For long-term context, prioritize information from related or similar queries.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Implicit context continuation', 'question_history': ["What's the largest mammal on Earth?", 'How long can blue whales live?', 'What do they eat?'], 'new_query': 'How deep can they dive?', 'expected': ['blue whales', 'diving depth'], 'unexpected': ['eat', 'lifespan']}, {'name': 'Context switch with similar terms', 'question_history': ["What's the largest planet in our solar system?", 'How many moons does Jupiter have?', "What's the Great Red Spot?", 'How long is a day on Jupiter?'], 'new_query': "What's the largest known star in the universe?", 'expected': ['largest star', 'universe'], 'unexpected': ['Jupiter', 'planet', 'solar system']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 10 ---
No change in instruction.

No change in test cases.

--- Iteration 11 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries.
Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities, and disregarding irrelevant or conflicting information. Prioritize recent, explicit context and accurate pronoun resolution.
3. If there's relevant context, incorporate it into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in complex context switches, long-term context recall scenarios, or mixed history. Prioritize information from related or similar queries and accurate pronoun resolution in long-term context.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Challenging context switch with indirect reference and mixed relevant and irrelevant history', 'question_history': ["Who is the author of 'To Kill a Mockingbird' and 'Go Set a Watchman'?", "What is the name of the main character in 'To Kill a Mockingbird'?", 'What is the capital of Alabama?', "What was the author's view on racial injustice?"], 'new_query': "What was the main character's profession in the book?", 'expected': ['main character', 'profession'], 'unexpected': ['capital', 'racial injustice', 'author']}, {'name': 'Context switch with similar terms', 'question_history': ["What's the largest planet in our solar system?", 'How many moons does Jupiter have?', "What's the Great Red Spot?", 'How long is a day on Jupiter?'], 'new_query': "What's the largest known star in the universe?", 'expected': ['largest star', 'universe'], 'unexpected': ['Jupiter', 'planet', 'solar system']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 12 ---
No change in instruction.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Challenging context switch with indirect reference and mixed relevant and irrelevant history', 'question_history': ["Who is the author of 'To Kill a Mockingbird' and 'Go Set a Watchman'?", "What is the name of the main character in 'To Kill a Mockingbird'?", 'What is the capital of Alabama?', "What was the author's view on racial injustice?"], 'new_query': "What was the main character's profession in the book?", 'expected': ['main character', 'profession'], 'unexpected': ['capital', 'racial injustice', 'author']}, {'name': 'Complex context switch with multiple entities and indirect reference', 'question_history': ['Who is the founder of the technology company Apple Inc.?', 'What is the name of the operating system developed by Apple Inc.?', 'What is the name of the tablet device released by Apple Inc. in 2010?', 'What is the name of the electric vehicle company founded by the same person who founded Apple Inc.?'], 'new_query': "What is the name of the operating system used in the vehicle's infotainment system?", 'expected': ['infotainment system', 'operating system'], 'unexpected': ['tablet device', '2010', "founder's name", 'electric vehicle company']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 13 ---
No change in instruction.

No change in test cases.

--- Iteration 14 ---
No change in instruction.

No change in test cases.

--- Iteration 15 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. If there's relevant context, incorporate it into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms, while handling complex context switches and subtle context changes.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.

No change in test cases.

--- Iteration 16 ---
No change in instruction.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Complex context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the lion character in the series who is also the creator of Narnia?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator']}, {'name': 'Complex context switch with multiple entities and indirect reference', 'question_history': ['Who is the founder of the technology company Apple Inc.?', 'What is the name of the operating system developed by Apple Inc.?', 'What is the name of the tablet device released by Apple Inc. in 2010?', 'What is the name of the electric vehicle company founded by the same person who founded Apple Inc.?'], 'new_query': "What is the name of the operating system used in the vehicle's infotainment system?", 'expected': ['infotainment system', 'operating system'], 'unexpected': ['tablet device', '2010', "founder's name", 'electric vehicle company']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 17 ---
No change in instruction.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Complex context switch with mixed relevant and irrelevant history', 'question_history': ["Who is the author of '1984' and 'Animal Farm'?", "What is the political ideology criticized in 'Animal Farm'?", "What's the tallest mountain in the United Kingdom?", "Who was the Prime Minister of the United Kingdom when the author of '1984' passed away?"], 'new_query': "What was the author's view on language manipulation?", 'expected': ['language manipulation', 'view'], 'unexpected': ['Mountain', 'Prime Minister']}, {'name': 'Complex context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the lion character in the series who is also the creator of Narnia?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 18 ---
No change in instruction.

No change in test cases.

--- Iteration 19 ---
No change in instruction.

No change in test cases.

--- Iteration 20 ---
No change in instruction.

No change in test cases.

--- Iteration 21 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms, while handling complex context switches, subtle context changes, and implicit context switches.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address ambiguous pronoun resolution, complex and subtle context switches, and implicit context switches with multiple entities and indirect references.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - challenging', 'question_history': ["Who is the author of 'Dune' and 'Children of Dune'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical substance that the main character seeks in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1984 film adaptation?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance', 'main character'], 'unexpected': ['Dune', 'magical substance', 'main antagonist', '1984 film adaptation', 'actor']}, {'name': 'Complex context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the lion character in the series who is also the creator of Narnia?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Subtle context switch with ambiguous pronoun resolution and mixed history', 'question_history': ["Who is the author of 'The Hobbit' and 'The Lord of the Rings'?", "What is the name of the character who is the ring-bearer in 'The Lord of the Rings'?", 'What is the name of the character who is the hobbit-friend of the ring-bearer?', "What is the name of the character who is the villain in 'The Lord of the Rings'?"], 'new_query': 'What does he say when he first encounters the ring-bearer?', 'expected': ['Sauron', 'first encounter'], 'unexpected': ['hobbit-friend', 'villain', 'friend', 'ring-bearer']}]

--- Iteration 22 ---
No change in instruction.

No change in test cases.

--- Iteration 23 ---
No change in instruction.

Improved test cases:
[{'name': 'Ambiguous pronoun resolution', 'question_history': ['Who was the first person to walk on the moon?', 'What was the name of his spacecraft?', 'When did he return to Earth?'], 'new_query': 'What did he say when he stepped onto the surface?', 'expected': ['Neil Armstrong', 'moon landing', 'first words'], 'unexpected': ['spacecraft', 'return to Earth']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - challenging', 'question_history': ["Who is the author of 'Dune' and 'Children of Dune'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical substance that the main character seeks in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1984 film adaptation?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance', 'main character'], 'unexpected': ['Dune', 'magical substance', 'main antagonist', '1984 film adaptation', 'actor']}, {'name': 'Complex context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the lion character in the series who is also the creator of Narnia?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'A Song of Ice and Fire' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2011 film adaptation?', "What is the name of the character who is the main character's sister in the series?"], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Valyrian steel sword', 'second book', 'first appearance'], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', 'main antagonist', '1911 film adaptation', 'actor', "main character's sister"]}]

--- Iteration 24 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - challenging', 'question_history': ["Who is the author of 'Dune' and 'Children of Dune'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical substance that the main character seeks in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1984 film adaptation?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance', 'main character'], 'unexpected': ['Dune', 'magical substance', 'main antagonist', '1984 film adaptation', 'actor']}, {'name': 'Complex context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the lion character in the series who is also the creator of Narnia?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'A Song of Ice and Fire' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2011 film adaptation?', "What is the name of the character who is the main character's sister in the series?"], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Valyrian steel sword', 'second book', 'first appearance'], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', 'main antagonist', '1911 film adaptation', 'actor', "main character's sister"]}]

--- Iteration 25 ---
Improved instruction:
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms, while handling complex and implicit context switches, subtle context changes, and indirect references.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities, subtle context shifts, and ambiguous pronoun resolution by carefully considering all possible interpretations and choosing the most likely one based on the overall context.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - challenging', 'question_history': ["Who is the author of 'Dune' and 'Children of Dune'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical substance that the main character seeks in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1984 film adaptation?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance', 'main character'], 'unexpected': ['Dune', 'magical substance', 'main antagonist', '1984 film adaptation', 'actor']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'A Song of Ice and Fire' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2011 film adaptation?', "What is the name of the character who is the main character's sister in the series?"], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Valyrian steel sword', 'second book', 'first appearance'], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', 'main antagonist', '1911 film adaptation', 'actor', "main character's sister"]}]

--- Iteration 26 ---
No change in instruction.

No change in test cases.

--- Iteration 27 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Subtle context switch with ambiguous pronouns and mixed relevant and irrelevant history - ultra-difficult', 'question_history': ["Who is the author of 'The Hunger Games' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2014 film adaptation?', 'Who is the president of the United States in 2021?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['district 13', 'second book', 'first appearance'], 'unexpected': ['The Hunger Games', 'main character', 'magical object', '2014 film adaptation', 'president of the United States']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift', 'question_history': ["Who is the author of 'The Wizard of Oz' and 'The Wonderful Wizard of Oz'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 1939 film adaptation?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['Narnia', 'second book', 'first appearance'], 'unexpected': ['main character', 'magical object', 'author', 'lion character', 'creator', 'main antagonist', '1939 film adaptation', 'actor']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'A Song of Ice and Fire' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2011 film adaptation?', "What is the name of the character who is the main character's sister in the series?"], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Valyrian steel sword', 'second book', 'first appearance'], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', 'main antagonist', '1911 film adaptation', 'actor', "main character's sister"]}]

--- Iteration 28 ---
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Handle complex context switches, subtle context changes, and indirect references by carefully considering all possible interpretations and choosing the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities, subtle context shifts, and ambiguous pronoun resolution by considering all possible interpretations and choosing the most likely one based on the overall context, including long-term context.

No change in test cases.

--- Iteration 29 ---
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities by:
   a. Carefully evaluating the relevance and recency of each entity in the history.
   b. Considering the possibility of multiple valid interpretations and choosing the most likely one based on the overall context, including long-term context.
   c. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Subtle context switch with ambiguous pronouns and mixed relevant and irrelevant history - ultra-difficult', 'question_history': ["Who is the author of 'The Hunger Games' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2014 film adaptation?', 'Who is the president of the United States in 2021?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['district 13', 'second book', 'first appearance'], 'unexpected': ['The Hunger Games', 'main character', 'magical object', '2014 film adaptation', 'president of the United States']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Subtle context switch with ambiguous pronouns, mixed relevant and irrelevant history, and complex entity relationships - ultra-imposing', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 1959 film adaptation?', 'Who is the current Prime Minister of the United Kingdom?'], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['pocket watch', 'third book', 'first appearance'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '1959 film adaptation', 'current Prime Minister of the United Kingdom']}, {'name': 'Implicit context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'A Song of Ice and Fire' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2011 film adaptation?', "What is the name of the character who is the main character's sister in the series?"], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['Valyrian steel sword', 'second book', 'first appearance'], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', 'main antagonist', '1911 film adaptation', 'actor', "main character's sister"]}]

--- Iteration 30 ---
No change in instruction.

No change in test cases.

--- Iteration 31 ---
No change in instruction.

No change in test cases.

--- Iteration 32 ---
No change in instruction.

No change in test cases.

--- Iteration 33 ---
No change in instruction.

No change in test cases.

--- Iteration 34 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Subtle context switch with ambiguous pronouns and mixed relevant and irrelevant history - ultra-difficult', 'question_history': ["Who is the author of 'The Hunger Games' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2014 film adaptation?', 'Who is the president of the United States in 2021?'], 'new_query': 'What does she say when she first appears in the second book of the series?', 'expected': ['district 13', 'second book', 'first appearance'], 'unexpected': ['The Hunger Games', 'main character', 'magical object', '2014 film adaptation', 'president of the United States']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Subtle context switch with ambiguous pronouns, mixed relevant and irrelevant history, and complex entity relationships - ultra-imposing', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 1959 film adaptation?', 'Who is the current Prime Minister of the United Kingdom?'], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['pocket watch', 'third book', 'first appearance'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '1959 film adaptation', 'current Prime Minister of the United Kingdom']}, {'name': 'Contextual query improvement ultra-marathon: Subtle context switch, ambiguous pronouns, and complex entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the third book of the series, after he has already appeared in the second book as a different entity?', 'expected': ['the third age', 'first appearance', 'different entity'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 35 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Subtle context switch with ambiguous pronouns, mixed relevant and irrelevant history, and complex entity relationships - ultra-imposing', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 1959 film adaptation?', 'Who is the current Prime Minister of the United Kingdom?'], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['pocket watch', 'third book', 'first appearance'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '1959 film adaptation', 'current Prime Minister of the United Kingdom']}, {'name': 'Contextual query improvement ultra-marathon: Subtle context switch, ambiguous pronouns, and complex entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the third book of the series, after he has already appeared in the second book as a different entity?', 'expected': ['the third age', 'first appearance', 'different entity'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 36 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Intricate contextual query with multiple ambiguous pronouns, misleading history, and complex entity relationships - super-extreme', 'question_history': ["Who is the author of 'A Song of Ice and Fire' and 'The Winds of Winter'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2011 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', '2011 film adaptation', 'actor', 'main antagonist']}, {'name': 'Contextual query improvement ultra-marathon: Subtle context switch, ambiguous pronouns, and complex entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the third book of the series, after he has already appeared in the second book as a different entity?', 'expected': ['the third age', 'first appearance', 'different entity'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 37 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Intricate contextual query with multiple ambiguous pronouns, misleading history, and complex entity relationships - super-extreme', 'question_history': ["Who is the author of 'A Song of Ice and Fire' and 'The Winds of Winter'?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2011 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['A Song of Ice and Fire', 'main character', 'magical object', '2011 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 38 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.

No change in test cases.

--- Iteration 39 ---
No change in instruction.

No change in test cases.

--- Iteration 40 ---
No change in instruction.

No change in test cases.

--- Iteration 41 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex and implicit context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance.

No change in test cases.

--- Iteration 42 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially when multiple entities are present.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Subtle context switch with multiple entities, indirect references, and complex history - ultra-challenging', 'question_history': ["Who is the author of 'The Silmarillion' and 'The Lord of the Rings'?", 'What is the name of the race of beings that the main character belongs to in the series?', 'What is the name of the magical object that the main character inherits in the first book of the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': 'What does he say when he first appears in the second book of the series?', 'expected': ['the second age', 'first appearance'], 'unexpected': ['The Silmarillion', "main character's race", 'magical object', 'main antagonist', '2001 film adaptation', 'actor']}, {'name': 'Complex contextual query with intricate entity relationships, ambiguous pronouns, and misleading history - ultra-demanding', 'question_history': ["Who is the author of 'The Hitchhiker's Guide to the Galaxy' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity, and having a significant role in the third book, but is also known for his role in a different series by the same author, which is not related to this query?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ["The Hitchhiker's Guide to the Galaxy", 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist', "the main character's friend's role in the different series"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 43 ---
No change in instruction.

No change in test cases.

--- Iteration 44 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, intricate entity relationships, and a misleading narrative direction - ultra-demanding', 'question_history': ["Who is the author of 'The Martian Chronicles' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the first book as a different entity and having a significant role in the third book, but is also known for his role in a different series by the same author, which is not related to this query, and the fact that his role in this series might seem contradictory to his role in the other series?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Martian Chronicles', 'main character', '2015 film adaptation', 'actor', "the main character's friend's role in the different series"]}, {'name': 'Complex contextual query with intricate entity relationships, ambiguous pronouns, and misleading history - ultra-demanding', 'question_history': ["Who is the author of 'The Hitchhiker's Guide to the Galaxy' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity, and having a significant role in the third book, but is also known for his role in a different series by the same author, which is not related to this query?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ["The Hitchhiker's Guide to the Galaxy", 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist', "the main character's friend's role in the different series"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 45 ---
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.

Improvement:
To better address the challenging test cases, add the following guideline:
f. When dealing with ultra-demanding or extreme test cases, consider using a weighted scoring system to evaluate the relevance and recency of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.

Improved test cases:
[{'name': 'Complex multi-layered context switch with multiple entities, indirect references, and subtle context shift - extremely challenging', 'question_history': ["Who is the author of 'The Lord of the Rings' trilogy?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character inherits in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2001 film adaptation?', "What is the name of the character who is the main character's friend and travel companion in the series?", "What is the name of the character who is the main character's son in the series?"], 'new_query': 'What does he say when he first appears in the third book of the series?', 'expected': ['Mordor', 'third book', 'first appearance'], 'unexpected': ['Lord of the Rings', 'main character', 'magical object', 'main antagonist', '2001 film adaptation', 'actor', "main character's friend", "main character's son"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, intricate entity relationships, and a misleading narrative direction - ultra-demanding', 'question_history': ["Who is the author of 'The Martian Chronicles' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the first book as a different entity and having a significant role in the third book, but is also known for his role in a different series by the same author, which is not related to this query, and the fact that his role in this series might seem contradictory to his role in the other series?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Martian Chronicles', 'main character', '2015 film adaptation', 'actor', "the main character's friend's role in the different series"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist - supremely-demanding', 'question_history': ["Who is the author of 'The Saga of the Seven Suns' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the second book, but is also known for her role in a different series by the same author, which is not related to this query, and the fact that her role in this series might seem contradictory to her role in the other series, while also considering the significant event that occurred in the second book that changed the course of the series?", 'expected': ['the fourth age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Saga of the Seven Suns', 'main character', 'magical object', '2023 film adaptation', 'actor', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 46 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist with an additional misleading subplot - supremely-demanding', 'question_history': ["Who is the author of 'The Dragonriders of Pern' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering her role in a misleading subplot in the first book that is not related to this query, and the fact that her role in this series might seem contradictory to her role in the misleading subplot, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, which is not related to this query?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dragonriders of Pern', 'main character', 'magical object', '2012 film adaptation', 'actor', 'main antagonist', 'the misleading subplot in the first book', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, intricate entity relationships, and a misleading narrative direction - ultra-demanding', 'question_history': ["Who is the author of 'The Martian Chronicles' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the first book as a different entity and having a significant role in the third book, but is also known for his role in a different series by the same author, which is not related to this query, and the fact that his role in this series might seem contradictory to his role in the other series?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Martian Chronicles', 'main character', '2015 film adaptation', 'actor', "the main character's friend's role in the different series"]}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist - supremely-demanding', 'question_history': ["Who is the author of 'The Saga of the Seven Suns' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the second book, but is also known for her role in a different series by the same author, which is not related to this query, and the fact that her role in this series might seem contradictory to her role in the other series, while also considering the significant event that occurred in the second book that changed the course of the series?", 'expected': ['the fourth age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Saga of the Seven Suns', 'main character', 'magical object', '2023 film adaptation', 'actor', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 47 ---
No change in instruction.

No change in test cases.

--- Iteration 48 ---
No change in instruction.

No change in test cases.

--- Iteration 49 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist with an additional misleading subplot - supremely-demanding', 'question_history': ["Who is the author of 'The Dragonriders of Pern' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering her role in a misleading subplot in the first book that is not related to this query, and the fact that her role in this series might seem contradictory to her role in the misleading subplot, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, which is not related to this query?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dragonriders of Pern', 'main character', 'magical object', '2012 film adaptation', 'actor', 'main antagonist', 'the misleading subplot in the first book', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist - supremely-demanding', 'question_history': ["Who is the author of 'The Saga of the Seven Suns' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the second book, but is also known for her role in a different series by the same author, which is not related to this query, and the fact that her role in this series might seem contradictory to her role in the other series, while also considering the significant event that occurred in the second book that changed the course of the series?", 'expected': ['the fourth age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity", 'main antagonist'], 'unexpected': ['The Saga of the Seven Suns', 'main character', 'magical object', '2023 film adaptation', 'actor', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 50 ---
No change in instruction.

No change in test cases.

--- Iteration 51 ---
No change in instruction.

No change in test cases.

--- Iteration 52 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist with an additional misleading subplot - supremely-demanding', 'question_history': ["Who is the author of 'The Dragonriders of Pern' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering her role in a misleading subplot in the first book that is not related to this query, and the fact that her role in this series might seem contradictory to her role in the misleading subplot, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, which is not related to this query?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dragonriders of Pern', 'main character', 'magical object', '2012 film adaptation', 'actor', 'main antagonist', 'the misleading subplot in the first book', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Expanse' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in this different entity, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Expanse', 'main character', 'magical object', '2015 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, misleading history, and intricate entity relationships with a twist - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the second book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book?", 'expected': ['the second age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist']}]

--- Iteration 53 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist with an additional misleading subplot - supremely-demanding', 'question_history': ["Who is the author of 'The Dragonriders of Pern' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering her role in a misleading subplot in the first book that is not related to this query, and the fact that her role in this series might seem contradictory to her role in the misleading subplot, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, which is not related to this query?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dragonriders of Pern', 'main character', 'magical object', '2012 film adaptation', 'actor', 'main antagonist', 'the misleading subplot in the first book', 'the significant event in the second book']}, {'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, and intricate entity relationships - ultra-extreme', 'question_history': ["Who is the author of 'The Wheel of Time' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2021 film adaptation?'], 'new_query': 'What does she say when she first appears in the fourth book of the series, after having been mentioned in the third book as a different entity, and considering her relationship with the magical object and the main antagonist?', 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object and main antagonist'], 'unexpected': ['The Wheel of Time', 'main character', 'magical object', '2021 film adaptation', 'actor', 'main antagonist']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Expanse' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in this different entity, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Expanse', 'main character', 'magical object', '2015 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with a misleading subplot twist - ultra-demanding', 'question_history': ["Who is the author of 'The Foundation' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, and the fact that he is also known for his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in this different series, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the first book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Foundation', 'main character', 'magical object', '2023 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}]

--- Iteration 54 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple layers of indirect references, ambiguous pronouns, intricate entity relationships, and a misleading narrative twist with an additional misleading subplot - supremely-demanding', 'question_history': ["Who is the author of 'The Dragonriders of Pern' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character receives in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering her role in a misleading subplot in the first book that is not related to this query, and the fact that her role in this series might seem contradictory to her role in the misleading subplot, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, which is not related to this query?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dragonriders of Pern', 'main character', 'magical object', '2012 film adaptation', 'actor', 'main antagonist', 'the misleading subplot in the first book', 'the significant event in the second book']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding with a focus on entity relationships', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2007 film adaptation?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the main character's friend, who is also a member of a different entity, and the magical object, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that her relationship with the main character's friend and the magical object is crucial to the narrative twist in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Expanse' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in this different entity, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Expanse', 'main character', 'magical object', '2015 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with a misleading subplot twist - ultra-demanding', 'question_history': ["Who is the author of 'The Foundation' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, and the fact that he is also known for his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in this different series, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the first book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Foundation', 'main character', 'magical object', '2023 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}]

--- Iteration 55 ---
Improved instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex context switches with multiple entities by:
   a. Evaluating the relevance and recency of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent and accurate information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant and accurate relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.
   f. When dealing with extreme test cases, consider using a weighted scoring system to evaluate the relevance and recency of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   g. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.

No change in test cases.

--- Iteration 56 ---
No change in instruction.

No change in test cases.

--- Iteration 57 ---
No change in instruction.

No change in test cases.

--- Iteration 58 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex context switches with multiple entities by:
   a. Evaluating the relevance, recency, and clarity of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance and clarity.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.
   f. When dealing with extreme test cases, consider using a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   g. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.

No change in test cases.

--- Iteration 59 ---
No change in instruction.

No change in test cases.

--- Iteration 60 ---
No change in instruction.

No change in test cases.

--- Iteration 61 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring extensive analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fifth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that her role in this series might seem contradictory to her role in a misleading subplot in the first book, and the fact that her role in this series might seem contradictory to her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the first book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', '2005 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding with a focus on entity relationships', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2007 film adaptation?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the main character's friend, who is also a member of a different entity, and the magical object, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that her relationship with the main character's friend and the magical object is crucial to the narrative twist in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Expanse' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in this different entity, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Expanse', 'main character', 'magical object', '2015 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with a misleading subplot twist - ultra-demanding', 'question_history': ["Who is the author of 'The Foundation' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, and the fact that he is also known for his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in this different series, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the first book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Foundation', 'main character', 'magical object', '2023 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}]

--- Iteration 62 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding with a focus on entity relationships', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2007 film adaptation?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the main character's friend, who is also a member of a different entity, and the magical object, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that her relationship with the main character's friend and the magical object is crucial to the narrative twist in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Expanse' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2015 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for her role in a different entity that is not related to this query, and the fact that her role in this series might seem contradictory to her role in this different entity, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Expanse', 'main character', 'magical object', '2015 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"]}, {'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with a misleading subplot twist - ultra-demanding', 'question_history': ["Who is the author of 'The Foundation' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, and the fact that he is also known for his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in this different series, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the first book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Foundation', 'main character', 'magical object', '2023 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}]

--- Iteration 63 ---
No change in instruction.

No change in test cases.

--- Iteration 64 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding with a focus on entity relationships', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2007 film adaptation?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the main character's friend, who is also a member of a different entity, and the magical object, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that her relationship with the main character's friend and the magical object is crucial to the narrative twist in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns across multiple questions, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2007 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the third book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'the main character in the first book', 'the main character in the fourth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with a misleading subplot twist - ultra-demanding', 'question_history': ["Who is the author of 'The Foundation' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2023 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the second book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the first book as a different entity and having a significant role in the third book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, and the fact that he is also known for his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in this different series, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the first book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the first book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Foundation', 'main character', 'magical object', '2023 film adaptation', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'the misleading subplot in the first book']}]

--- Iteration 65 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:
1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex context switches with multiple entities by:
   a. Evaluating the relevance, recency, and clarity of each entity in the history and prioritizing the most likely interpretation based on the overall context, while considering alternative interpretations in cases of equal relevance and clarity.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.
   f. When dealing with extreme test cases, consider using a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   g. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   h. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switches, ambiguous pronouns, misleading history, intricate entity relationships, and a narrative twist requiring extensive analysis - ultra-demanding with a focus on entity relationships', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the character who is the main antagonist in the series?', 'Who is the actor who played the main character in the 2007 film adaptation?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the main character's friend, who is also a member of a different entity, and the magical object, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that her relationship with the main character's friend and the magical object is crucial to the narrative twist in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', "relationship with main character's friend and different entity", 'relationship with magical object', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns across multiple questions, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2007 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the third book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'the main character in the first book', 'the main character in the fourth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 66 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.
   f. When dealing with extreme test cases, consider using a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   g. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   h. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Ultra-complex contextual query with extreme subtlety, ambiguous pronouns, mixed relevant and irrelevant history, and implicit context requiring exceptional analysis - absolutely-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns across multiple questions, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2007 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the third book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'the main character in the first book', 'the main character in the fourth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 67 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Ultra-complex contextual query with multi-layered ambiguity, intricate entity relationships, and implicit context requiring exceptional analysis - insanely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity, and the fact that his role in this series might seem contradictory to his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the fact that his role in this series might seem contradictory to his role in a different series by the same author?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author', 'the significant event in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns across multiple questions, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2007 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the third book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'the main character in the first book', 'the main character in the fourth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 68 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns across multiple questions, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2007 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the third book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'the main character in the first book', 'the main character in the fourth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fourth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 69 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent.
   f. When dealing with extreme test cases, consider using a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   g. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   h. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   i. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

No change in test cases.

--- Iteration 70 ---
No change in instruction.

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Lord of the Rings' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Lord of the Rings', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the 2001 film adaptation', 'the role in another series by the same author']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 71 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

Total score: -19 (Improvement target: 100)

Improved test cases:
[{'name': 'Complex contextual query with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships with misleading history and a narrative twist requiring extensive analysis - ultra-demanding', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'What is the name of the main character in the fifth book of the series?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the fourth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main character in the fifth book, after having been mentioned in the third book as a different entity and having a significant role in the second book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the first book that changed the course of the series, but is also known for her role in a different series by the same author, and the fact that her role in this series might seem contradictory to her role in this different series, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'main character in the first book', 'main character in the fifth book', 'main character in the fourth book', 'main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the second age', 'first appearance', 'relationship with magical object', "main character's friend and different entity", 'main character in the fifth book', 'the misleading subplot in the second book']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the 2001 film adaptation', 'the role in another series by the same author']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 72 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

To improve performance on the test cases, pay particular attention to:

- Resolving ambiguities in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Approaching tasks with heightened skepticism in cases with narrative twists or misleading history.

No change in test cases.

--- Iteration 73 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

To improve performance on the test cases, pay particular attention to:

- Resolving ambiguities in complex contextual queries with multiple ambiguous pronouns and subtle context switches by prioritizing recent, accurate, and clear information.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Approaching tasks with heightened skepticism in cases with narrative twists or misleading history by verifying information against the new query and considering alternative explanations.
- Allocating extra time and resources for ultra-demanding and extreme test cases to ensure thorough analysis and validation of the final query.

Improved test cases:
[{'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not mentioned in the question history, and the fact that his role in this series might seem contradictatory to his role in this different entity, and the fact that his role in this series might seem contradictory to his role in the other series by the same author, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', 'actor', 'actor who played the main character', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the role in a different entity', 'the role in the other series by the same author']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the 2001 film adaptation', 'the role in another series by the same author']}, {'name': 'Extremely complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Chronicles of Narnia' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2005 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the fifth book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the third book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the third book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the third book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the third book?", 'expected': ['the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Chronicles of Narnia', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the fifth book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the fifth age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the third book']}]

--- Iteration 74 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

To improve performance on the test cases, pay particular attention to:

- Resolving ambiguities in complex contextual queries with multiple ambiguous pronouns and subtle context switches by prioritizing recent, accurate, and clear information.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Validating your interpretation and query refinement decions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Approaching tasks with heightened skepticism in cases with narrative twists or misleading history by verifying information against the new query and considering alternative explanations.
- Allocating extra time and resources for ultra-demanding and extreme test cases to ensure thorough analysis and validation of the final query.

No change in test cases.

--- Iteration 75 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, explicit context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Approaching tasks with heightened skepticism in cases with narrative twists or misleading history.
- Allocating extra time and resources for ultra-demanding and extreme test cases.

No change in test cases.

--- Iteration 76 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Use context to resolve ambiguities, clarify intent, and accurately resolve pronouns, especially in complex cases with multiple entities.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Prioritize recent, accurate context, accurate pronoun resolution, and indirect references, while considering alternative interpretations in complex context switches and ambiguous cases.
3. Incorporate relevant context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms. Carefully consider all possible interpretations for complex context switches, subtle context changes, and indirect references, and choose the most likely one based on the overall context, including long-term context.
4. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
5. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context. Specifically, address complex cases with multiple ambiguous pronouns and entities by:
   a. Evaluating the relevance, recency, and clarity of each entity and pronoun in the history, prioritizing the most likely interpretation based on the overall context, and considering alternative interpretations when necessary.
   b. Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible, and providing context when necessary to maintain accuracy.
   c. When faced with mixed relevant and irrelevant history, focus on the most recent, accurate, and clear information, and carefully consider the possibility of multiple valid interpretations, providing the most likely interpretation first and alternative interpretations if applicable.
   d. In cases with complex entity relationships, prioritize the most relevant, accurate, and clear relationships when resolving ambiguities and constructing the final query, and provide additional context to ensure clarity when needed.
   e. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance, while considering the overall context and user intent. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations.
   f. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.
   g. In cases with narrative twists or misleading history, approach the task with heightened skepticism, verifying information against the new query and considering alternative explanations to ensure accurate interpretation.
   h. For ultra-demanding and extreme test cases, allocate extra time and resources to ensure thorough analysis and validation of the final query.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Approaching tasks with heightened skepticism in cases with narrative twists or misleading history.
- Allocating extra time and resources for ultra-demanding and extreme test cases.
- Utilizing a weighted scoring system for objective and consistent interpretation prioritization in extreme test cases.

Improved test cases:
[{'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not mentioned in the question history, and the fact that his role in this series might seem contradictatory to his role in this different entity, and the fact that his role in this series might seem contradictory to his role in the other series by the same author, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', 'actor', 'actor who played the main character', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the role in a different entity', 'the role in the other series by the same author']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the 2001 film adaptation', 'the role in another series by the same author']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'Harry Potter' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the seventh book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the fourth book as a different entity and having a significant role in the fifth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the fourth book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in a different series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the fourth book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the fourth book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in a different series by the same author that is not mentioned in the question history?", 'expected': ['the seventh age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['Harry Potter', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the seventh book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the seventh age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the fourth book', 'the 2001 film adaptation', 'the role in a different series by the same author']}]

--- Iteration 77 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Incorporate this context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Utilizing a weighted scoring system for objective and consistent interpretation prioritization in extreme test cases.
- Allocating extra time and resources for ultra-demanding and extreme test cases.

No change in test cases.

--- Iteration 78 ---
No change in instruction.

No change in test cases.

--- Iteration 79 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Incorporate this context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Utilizing a weighted scoring system for objective and consistent interpretation prioritization in extreme test cases.
- Allocating extra time and resources for ultra-demanding and extreme test cases.
- Implementing a "minimum context" rule, where you only consider the most recent and relevant context to prevent over-complication and ensure efficiency.
- Emphasizing the importance of resolving ambiguities and inconsistencies in the query history before incorporating any context into the new query.

No change in test cases.

--- Iteration 80 ---
Improved instruction:
Revised instruction:
You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches.
2. Identify relevant context from the query history that directly relates to the new query, resolving ambiguities and disregarding irrelevant or conflicting information. Incorporate this context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, but still ensure conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query to ensure accuracy and relevance. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history, ensuring a more objective and consistent approach to prioritizing interpretations. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query to avoid over-complicating the query with unnecessary context.
- Utilizing a weighted scoring system for objective and consistent interpretation prioritization in extreme test cases.
- Allocating extra time and resources for ultra-demanding and extreme test cases.
- Implementing a "minimum context" rule, where you only consider the most recent and relevant context to prevent over-complication and ensure efficiency.
- Emphasizing the importance of resolving ambiguities and inconsistencies in the query history before incorporating any context into the new query.
- For complex and extreme cases, consider using a separate analysis phase to identify and resolve ambiguities, misleading information, and subtle context switches before incorporating context into the new query.

No change in test cases.

--- Iteration 81 ---
No change in instruction.

No change in test cases.

--- Iteration 82 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment and avoid over-complicating the query with unnecessary context. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases.

To improve performance on the test cases, focus on:

- Prioritizing recent, accurate, and clear information in complex contextual queries with multiple ambiguous pronouns and subtle context switches.
- Ensuring clarity and specificity in the final query, avoiding ambiguous pronouns and indirect references when possible.
- Regularly validating your interpretation and query refinement decisions against the original intent of the new query.
- Utilizing a weighted scoring system for objective and consistent interpretation prioritization in extreme test cases.
- Allocating extra time and resources for ultra-demanding and extreme test cases.
- Implementing a "minimum context" rule in complex cases.
- Emphasizing the importance of resolving ambiguities and inconsistencies in the query history before incorporating any context.
- Using a separate analysis phase for complex and extreme cases to identify and resolve ambiguities, misleading information, and subtle context switches.

No change in test cases.

--- Iteration 83 ---
No change in instruction.

No change in test cases.

--- Iteration 84 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For extreme test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy.

No change in test cases.

--- Iteration 85 ---
No change in instruction.

No change in test cases.

--- Iteration 86 ---
No change in instruction.

No change in test cases.

--- Iteration 87 ---
No change in instruction.

No change in test cases.

--- Iteration 88 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy. Additionally, consider the possibility of multiple valid interpretations and, if necessary, generate a list of refined search queries ranked by confidence level.

No change in test cases.

--- Iteration 89 ---
No change in instruction.

No change in test cases.

--- Iteration 90 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, focusing on pronouns, recent history, implicit and explicit context, similar terms, and long-term context. Prioritize recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy. Additionally, consider the possibility of multiple valid interpretations and, if necessary, generate a list of refined search queries ranked by confidence level.

Performance improvement:

- When encountering misleading history, explicitly verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, consider using entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.

No change in test cases.

--- Iteration 91 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy. Additionally, consider the possibility of multiple valid interpretations and, if necessary, generate a list of refined search queries ranked by confidence level.

Performance improvement:

- When encountering misleading history, explicitly verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.

No change in test cases.

--- Iteration 92 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns and subtle context switches. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy. Additionally, consider the possibility of multiple valid interpretations and, if necessary, generate a list of refined search queries ranked by confidence level.

Performance improvement:

- When encountering misleading history, explicitly verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.
- Regularly reassess and adjust your approach based on user feedback and performance metrics to continuously improve your query enhancement capabilities.

No change in test cases.

--- Iteration 93 ---
No change in instruction.

No change in test cases.

--- Iteration 94 ---
No change in instruction.

No change in test cases.

--- Iteration 95 ---
No change in instruction.

No change in test cases.

--- Iteration 96 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context, using entity normalization techniques for consistency.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy.

Performance improvement:

- When encountering misleading history, explicitly verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.
- Regularly reassess and adjust your approach based on user feedback and performance metrics to continuously improve your query enhancement capabilities.

No change in test cases.

--- Iteration 97 ---
No change in instruction.

No change in test cases.

--- Iteration 98 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information, especially in complex cases with multiple ambiguous pronouns, subtle context switches, and intricate entity relationships. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context, using entity normalization techniques for consistency.
2. Identify relevant context from the query history that directly relates to the new query, incorporating this context into a refined search query. Ensure clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent, even in challenging scenarios. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy.

Performance improvement:

- When encountering misleading history, explicitly verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.
- Regularly reassess and adjust your approach based on user feedback and performance metrics to continuously improve your query enhancement capabilities.
- In ambiguous pronoun cases, consider the entire context history to ensure accurate resolution and avoid misinterpretation.

No change in test cases.

--- Iteration 99 ---
Improved instruction:
Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information. Use entity normalization techniques to ensure consistency and accuracy in context incorporation. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query. Incorporate this context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy.

Performance improvement:

- When encountering misleading history, verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.
- Regularly reassess and adjust your approach based on user feedback and performance metrics to continuously improve your query enhancement capabilities.
- In ambiguous pronoun cases, consider the entire context history to ensure accurate resolution and avoid misinterpretation.

No change in test cases.

--- Iteration 100 ---
No change in instruction.

No change in test cases.
Final Results:
Instruction: Revised instruction:

You are an AI assistant tasked with enhancing search queries by incorporating relevant context from previous queries. Your goal is to generate a concise, accurate search query that reflects the intent of the new question, considering past context.

Instructions:

1. Analyze the new query and query history, prioritizing recent, accurate, and clear information. Use entity normalization techniques to ensure consistency and accuracy in context incorporation. Disregard irrelevant or misleading information and resolve ambiguities before incorporating context.
2. Identify relevant context from the query history that directly relates to the new query. Incorporate this context into a refined search query, ensuring clarity, specificity, correct pronoun resolution, and context continuity using similar terms.
3. If there's no relevant context, focus solely on the new query, ensuring conciseness, targeted intent, correct term interpretation, and accurate pronoun resolution, particularly in ambiguous cases.
4. Ensure the final query is concise, targeted, unambiguous, and accurately captures the user's intent. Prioritize information from related or similar queries, accurate pronoun resolution, and indirect references in long-term context.
5. For complex test cases, maintain a systematic approach, breaking down the task into smaller steps, and iteratively refining the search query. Utilize a weighted scoring system to evaluate the relevance, recency, clarity, and accuracy of each entity and interpretation in the history. Regularly validate your interpretation and query refinement decisions against the original intent of the new query to ensure alignment. Implement a "minimum context" rule, considering only the most recent and relevant context in complex cases. In ambiguous cases, prioritize direct references over indirect ones and prefer specific terms over general ones to enhance clarity and accuracy.

Performance improvement:

- When encountering misleading history, verify the accuracy of the information before incorporating it into the refined query.
- For intricate entity relationships, use entity normalization techniques to ensure consistency and accuracy in context incorporation.
- In cases with multiple valid interpretations, provide a brief explanation for each interpretation to help users make informed decisions.
- In ultra-demanding and complex cases, allocate additional processing time and resources to ensure thorough analysis and accurate query refinement.
- Regularly reassess and adjust your approach based on user feedback and performance metrics to continuously improve your query enhancement capabilities.
- In ambiguous pronoun cases, consider the entire context history to ensure accurate resolution and avoid misinterpretation.
Test Cases: [{'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not mentioned in the question history, and the fact that his role in this series might seem contradictatory to his role in this different entity, and the fact that his role in this series might seem contradictory to his role in the other series by the same author, and the fact that he is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that he is not the main antagonist, but has a significant role in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not a different entity, but is often mistaken for a different entity due to his complex relationships with other characters in the series, and the fact that he is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that his role in this series might seem contradictory to his role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Dark Tower', 'main character', 'magical object', 'actor', 'actor who played the main character', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the role in a different entity', 'the role in the other series by the same author']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Hobbit' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2012 film adaptation?', 'What is the name of the character who is the main antagonist in the series?', 'What is the name of the character who is the main antagonist in a different series by the same author?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the first book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the other series by the same author, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Hobbit', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book']}, {'name': 'Complex contextual query with subtle context switch, ambiguous pronouns, and implicit context requiring careful analysis - supremely-demanding', 'question_history': ["Who is the author of 'The Dark Tower' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2017 film adaptation?'], 'new_query': "What does he say when he first appears in the third book of the series, considering his relationship with the magical object and the main character's friend, who is also a member of a different entity, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that his role in this series might seem contradictory to his role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, but is also known for his role in a different entity that is not related to this query, and the fact that his role in this series might seem contradictory to his role in this different entity?", 'expected': ['the third age', 'first appearance', 'different entity', 'relationship with magical object', "main character's friend and different entity"], 'unexpected': ['The Dark Tower', 'main character', 'magical object', '2017 film adaptation', 'actor', 'the significant event in the second book', "the main character's friend's role in the different entity", 'the role in the different series by the same author']}, {'name': 'Ultra-demanding contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'The Witcher' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character possesses in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the third book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the second book as a different entity and having a significant role in the fourth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the second book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the second book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in another series by the same author that is not mentioned in the question history?", 'expected': ['the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['The Witcher', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the third book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the third age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the second book', 'the 2001 film adaptation', 'the role in another series by the same author']}, {'name': 'Ultra-complex contextual query with multiple subtle context switches, ambiguous pronouns, misleading history, implicit context, and intricate entity relationships requiring extensive analysis', 'question_history': ["Who is the author of 'Harry Potter' series?", 'What is the name of the main character in the first book of the series?', 'What is the name of the magical object that the main character discovers in the first book?', 'Who is the actor who played the main character in the 2001 film adaptation?', 'What is the name of the character who is the main antagonist in the series?'], 'new_query': "What does she say when she first appears in the seventh book of the series, considering her relationship with the magical object, the main character's friend who is also a member of a different entity, and the main antagonist, after having been mentioned in the fourth book as a different entity and having a significant role in the fifth book, while also considering the fact that her role in this series might seem contradictory to her role in a different series by the same author, and the significant event that occurred in the fourth book that changed the course of the series, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in a different series by the same author that is not mentioned in the question history, and the fact that she is not the main character, but is often mistaken for the main character due to their similar names and roles in the series, and the fact that she is not the main antagonist, but has a significant role in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not a different entity, but is often mistaken for a different entity due to her complex relationships with other characters in the series, and the fact that she is not the same character as the one mentioned in the misleading subplot in the fourth book, and the fact that her role in this series might seem contradictory to her role in the misleading subplot in the fourth book, and the fact that her role in this series might seem contradictory to her role in the 2001 film adaptation, and the fact that her role in this series might seem contradictory to her role in a different series by the same author that is not mentioned in the question history?", 'expected': ['the seventh age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist'], 'unexpected': ['Harry Potter', 'main character', 'magical object', 'actor', 'main character in the first book', 'main character in the seventh book', 'the main antagonist', 'the main character', 'the main antagonist', 'different entity', 'the seventh age', 'first appearance', 'relationship with magical object', 'relationship with main antagonist', 'the misleading subplot in the fourth book', 'the 2001 film adaptation', 'the role in a different series by the same author']}]
